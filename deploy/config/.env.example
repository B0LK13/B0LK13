# AI Agentic SOC Configuration
# Copy this file to ../deploy/.env and fill in your values
# NEVER commit the .env file with actual secrets to version control

################################################################################
# API Keys and Credentials
################################################################################

# OpenAI API Configuration
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4o
OPENAI_TEMPERATURE=0.2
OPENAI_MAX_TOKENS=2000

# Alternative LLM Providers (uncomment if using)
# ANTHROPIC_API_KEY=sk-your-anthropic-key-here
# GOOGLE_AI_API_KEY=your-google-ai-key-here
# AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com/
# AZURE_OPENAI_API_KEY=your-azure-key-here

################################################################################
# SIEM Configuration
################################################################################

# SIEM Type: elastic, splunk, qradar, sentinel
SIEM_TYPE=elastic
SIEM_HOST=localhost
SIEM_PORT=9200
SIEM_API_KEY=your-siem-api-key-here
SIEM_USERNAME=admin
SIEM_PASSWORD=changeme

# Splunk Specific
SPLUNK_HOST=localhost
SPLUNK_PORT=8089
SPLUNK_TOKEN=your-splunk-token-here

# Elastic Specific
ELASTIC_HOST=localhost
ELASTIC_PORT=9200
ELASTIC_USERNAME=elastic
ELASTIC_PASSWORD=changeme

################################################################################
# EDR Configuration
################################################################################

# EDR Type: crowdstrike, sentinelone, defender, carbonblack
EDR_TYPE=crowdstrike
EDR_API_KEY=your-edr-api-key-here
EDR_CLIENT_ID=your-client-id-here
EDR_CLIENT_SECRET=your-client-secret-here

# CrowdStrike Specific
CROWDSTRIKE_CLIENT_ID=your-client-id-here
CROWDSTRIKE_CLIENT_SECRET=your-client-secret-here
CROWDSTRIKE_BASE_URL=https://api.crowdstrike.com

# SentinelOne Specific
SENTINELONE_API_TOKEN=your-sentinelone-token-here
SENTINELONE_BASE_URL=https://your-instance.sentinelone.net

################################################################################
# Agent Configuration
################################################################################

# Agent Behavior
AGENT_MODEL=gpt-4o
AGENT_TEMPERATURE=0.2
AGENT_MAX_ITERATIONS=5
AGENT_TIMEOUT=300
AGENT_VERBOSE=true

# Agent Limits
MAX_CONCURRENT_AGENTS=10
AGENT_MEMORY_LIMIT=512
AGENT_CPU_LIMIT=2

# Agent Types
ENABLE_TRIAGE_AGENT=true
ENABLE_INVESTIGATION_AGENT=true
ENABLE_RESPONSE_AGENT=false  # Set to false initially for safety

################################################################################
# Database Configuration
################################################################################

# PostgreSQL
DB_TYPE=postgresql
DB_HOST=localhost
DB_PORT=5432
DB_NAME=agentic_soc
DB_USER=soc_admin
DB_PASSWORD=changeme
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# Redis (for caching and queues)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_URL=redis://${REDIS_HOST}:${REDIS_PORT}

################################################################################
# SOAR Configuration
################################################################################

# SOAR Platform: xsoar, phantom, swimlane
SOAR_TYPE=xsoar
SOAR_HOST=localhost
SOAR_PORT=443
SOAR_API_KEY=your-soar-api-key-here

# Cortex XSOAR
XSOAR_API_KEY=your-xsoar-api-key-here
XSOAR_BASE_URL=https://your-xsoar-instance.com

################################################################################
# Dashboard Configuration
################################################################################

# Web Dashboard
DASHBOARD_PORT=3000
DASHBOARD_HOST=0.0.0.0
DASHBOARD_SECRET_KEY=your-secret-key-here-change-this

# Grafana
GRAFANA_PORT=3001
GRAFANA_ADMIN_USER=admin
GRAFANA_ADMIN_PASSWORD=changeme

# Authentication
AUTH_ENABLED=true
AUTH_TYPE=oauth  # oauth, basic, none
OAUTH_CLIENT_ID=your-oauth-client-id
OAUTH_CLIENT_SECRET=your-oauth-client-secret
OAUTH_CALLBACK_URL=http://localhost:3000/auth/callback

################################################################################
# Monitoring and Logging
################################################################################

# Log Level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO
LOG_DIR=/var/log/agentic-soc
LOG_MAX_SIZE=100M
LOG_RETENTION_DAYS=90

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090
PROMETHEUS_ENDPOINT=http://localhost:9090

# Alerting
ENABLE_ALERTING=true
ALERT_EMAIL=your-email@example.com
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@example.com
SMTP_PASSWORD=your-app-password

################################################################################
# Security and Governance
################################################################################

# Sandbox Configuration
SANDBOX_ENABLED=true
SANDBOX_NETWORK_ISOLATED=true
SANDBOX_TIMEOUT=3600

# Human-in-the-Loop
HITL_ENABLED=true
HITL_THRESHOLD=high  # Actions above this severity require approval: low, medium, high, critical
HITL_TIMEOUT=300  # Seconds to wait for approval

# Audit Trail
AUDIT_ENABLED=true
AUDIT_DB_RETENTION_DAYS=365

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60

################################################################################
# Threat Intelligence
################################################################################

# Threat Intel Feeds
ENABLE_THREAT_INTEL=true
VIRUSTOTAL_API_KEY=your-virustotal-key-here
ABUSEIPDB_API_KEY=your-abuseipdb-key-here
ALIENVAULT_OTX_API_KEY=your-otx-key-here

# MISP
MISP_ENABLED=false
MISP_URL=https://your-misp-instance.com
MISP_API_KEY=your-misp-api-key-here

################################################################################
# Orchestration
################################################################################

# CrewAI Configuration
CREWAI_ENABLED=true
CREWAI_MAX_AGENTS=10
CREWAI_EXECUTION_MODE=sequential  # sequential, parallel

# LangChain Configuration
LANGCHAIN_TRACING=true
LANGCHAIN_ENDPOINT=https://api.smith.langchain.com
LANGCHAIN_API_KEY=your-langchain-api-key-here
LANGCHAIN_PROJECT=agentic-soc

################################################################################
# Cloud Provider (Optional)
################################################################################

# AWS
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key

# Azure
AZURE_SUBSCRIPTION_ID=your-subscription-id
AZURE_TENANT_ID=your-tenant-id
AZURE_CLIENT_ID=your-client-id
AZURE_CLIENT_SECRET=your-client-secret

# GCP
GCP_PROJECT_ID=your-project-id
GCP_SERVICE_ACCOUNT_KEY=path/to/service-account-key.json

################################################################################
# Development and Testing
################################################################################

# Environment
ENVIRONMENT=development  # development, staging, production
DEBUG=true

# Testing
TEST_MODE=false
MOCK_SIEM=false
MOCK_EDR=false
MOCK_LLM=false

# Atomic Red Team (for testing)
ATOMIC_RED_TEAM_PATH=/opt/atomic-red-team
ENABLE_ART_TESTS=false

################################################################################
# Performance Tuning
################################################################################

# Worker Configuration
WORKER_PROCESSES=4
WORKER_THREADS=8
QUEUE_BACKEND=redis

# Caching
CACHE_ENABLED=true
CACHE_TTL=3600
CACHE_BACKEND=redis

# Batch Processing
BATCH_SIZE=100
BATCH_TIMEOUT=30

################################################################################
# Compliance and Reporting
################################################################################

# Compliance Standards
COMPLIANCE_GDPR=true
COMPLIANCE_SOC2=true
COMPLIANCE_NIST=true

# Reporting
ENABLE_REPORTS=true
REPORT_FREQUENCY=daily  # daily, weekly, monthly
REPORT_EMAIL=reports@example.com

################################################################################
# Feature Flags
################################################################################

# Enable/Disable Features
FEATURE_AUTO_REMEDIATION=false  # Start with manual approval
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_THREAT_HUNTING=true
FEATURE_INCIDENT_RESPONSE=true
FEATURE_VULNERABILITY_MANAGEMENT=false

################################################################################
# Custom Integrations
################################################################################

# ServiceNow
SERVICENOW_ENABLED=false
SERVICENOW_INSTANCE=your-instance.service-now.com
SERVICENOW_USERNAME=your-username
SERVICENOW_PASSWORD=your-password

# Jira
JIRA_ENABLED=false
JIRA_URL=https://your-domain.atlassian.net
JIRA_USERNAME=your-email@example.com
JIRA_API_TOKEN=your-jira-api-token

# Slack
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
SLACK_CHANNEL=#security-alerts

# Microsoft Teams
TEAMS_ENABLED=false
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/WEBHOOK/URL
